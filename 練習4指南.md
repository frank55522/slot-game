# H5_Slot_ç·´ç¿’4 ç°¡å ±æŒ‡å—

## é¡Œç›®ä¸€ï¼šGameLogo Bundle è¼‰å…¥èˆ‡é¡¯ç¤º

### ğŸ¯ æ ¸å¿ƒé‡é»
1. **preloadéšæ®µè¼‰å…¥** gameLogo Bundle
2. **å¤šèªç³»é¡¯ç¤º** ä¾ç…§èªç³»è‡ªå‹•åˆ‡æ›Logoåœ–ç‰‡
3. **é»æ“Š/è‡ªå‹•é—œé–‰** 3ç§’è‡ªå‹•é—œé–‰æˆ–é»æ“Šä»»ä½•ä½ç½®é—œé–‰
4. **æµç¨‹æ§åˆ¶** Logoé—œé–‰å¾Œæ‰èƒ½é€²å…¥éŠæˆ²

### ğŸ“ è³‡æºçµæ§‹
```
assets/prefabs/gameLogo/GameLogo.prefab
assets/art/language/{en,zh,th}/intro/GameLogo.png
```

### ğŸ’¡ é—œéµæŠ€è¡“
- **Bundleè¼‰å…¥æ™‚æ©Ÿ**ï¼šåœ¨`setLoadList()`çš„baseLoadä¸­è¼‰å…¥
- **å¤šèªç³»æ”¯æ´**ï¼šä½¿ç”¨`LocalizedSprite`çµ„ä»¶è‡ªå‹•åˆ‡æ›
- **åœ–å±¤ç®¡ç†**ï¼šä½¿ç”¨`LayerManager.setLayer(999)`ç¢ºä¿æœ€ä¸Šå±¤é¡¯ç¤º
- **è¼¸å…¥è™•ç†**ï¼šå…¨åŸŸè¼¸å…¥ç›£è½æ”¯æ´æ»‘é¼ +è§¸æ§

---

## ğŸ”§ æ ¸å¿ƒç¨‹å¼ç¢¼

### 1. Bundleè¼‰å…¥é…ç½®
`LoadingViewMediator.ts:167-172`
```typescript
{
    status: LoadStatus.NONE,
    info: { bundleName: 'gameLogo', assetName: 'GameLogo' },
    onTaskFinished: (prefab: Prefab) => {
        this.gameLogoPrefab = prefab;
}
```

### 2. å±¬æ€§å®šç¾©
`LoadingViewMediator.ts:391-394`
```typescript
private gameLogoPrefab: Prefab | null = null;
private gameLogoNode: Node | null = null;
private logoCloseTimer: number = 0;
private canEnterGame: boolean = false;
```

### 3. é¡¯ç¤ºæ™‚æ©Ÿæ§åˆ¶
`LoadingViewMediator.ts:181-196`
```typescript
protected delayEnterLobby(): void {
    if (this.gameLogoPrefab && !this.gameLogoNode) {
        this.showGameLogo(this.gameLogoPrefab);
        return;
    }
    if (!this.canEnterGame) {
        return;
    }
    this.enterGameAfterLogo();
}
```

### 4. Logoé¡¯ç¤ºèˆ‡è¼¸å…¥è™•ç†
`LoadingViewMediator.ts:399-416`
```typescript
private showGameLogo(prefab: Prefab) {
    this.gameLogoNode = instantiate(prefab);
    director.getScene().addChild(this.gameLogoNode);

    const dummyComponent = this.gameLogoNode.addComponent(Component);
    LayerManager.setLayer(dummyComponent, 999);

    this.startInputListening();

    this.logoCloseTimer = window.setTimeout(() => {
        this.closeGameLogo();
    }, 3000);
}
```

### 5. é—œé–‰è™•ç†
`LoadingViewMediator.ts:440-465`
```typescript
private closeGameLogo() {
    if (this.gameLogoNode) {
        clearTimeout(this.logoCloseTimer);
        this.stopInputListening();
        this.gameLogoNode.destroy();
        this.gameLogoNode = null;
        this.canEnterGame = true;

        if (this.isInitData) {
            this.enterGameAfterLogo();
        }
    }
}
```

---

## é¡Œç›®äºŒï¼šSymbol å‹•ç•«å¯¦ä½œ

### ğŸ¯ æ ¸å¿ƒé‡é»
1. **çµ±ä¸€å‹•ç•«æ•ˆæœ** æ‰€æœ‰symbolä¸­çæ™‚éƒ½æ’­æ”¾æ”¾å¤§2å€å†ç¸®å°å›1å€çš„å‹•ç•«
2. **ä½¿ç”¨TimelineTool** æ¡ç”¨å°ˆæ¡ˆåŸæœ‰çš„TimelineToolç³»çµ±å¯¦ä½œ
3. **AllWinå’ŒLoopWinçµ±ä¸€** å…©å€‹è¡¨æ¼”éšæ®µä½¿ç”¨ç›¸åŒå‹•ç•«
4. **æ“´å±•æ€§ä½³** ä»»ä½•symbolåªè¦é…ç½®TimelineTooléƒ½èƒ½æœ‰å‹•ç•«æ•ˆæœ

### ğŸ’¡ é—œéµæŠ€è¡“
- **TimelineToolç³»çµ±**ï¼šä½¿ç”¨å°ˆæ¡ˆåŸæœ‰çš„å‹•ç•«æ¡†æ¶
- **ç¹¼æ‰¿æ¶æ§‹**ï¼šç¹¼æ‰¿SymbolAllWinStateå’ŒSymbolLoopWinState
- **Cocos Creator Animation**ï¼šåœ¨Mainç¯€é»é…ç½®ç¸®æ”¾å‹•ç•«
- **å‹•ç•«çµ±ä¸€ç®¡ç†**ï¼šä½¿ç”¨ç›¸åŒçš„'ScaleEffect'å‹•ç•«åç¨±

---

## ğŸ”§ æ ¸å¿ƒç¨‹å¼ç¢¼

### 1. SymbolContentæ·»åŠ TimelineToolæ”¯æ´
`Game_1_SymbolContent.ts`
```typescript
import { TimelineTool } from 'TimelineTool';

@ccclass('Game_1_SymbolContent')
export class Game_1_SymbolContent extends SymbolContentBase {
    // ... å…¶ä»–å±¬æ€§
    @property({ type: TimelineTool, visible: true })
    public timelineTool: TimelineTool | null = null;
}
```

### 2. å‰µå»ºç¹¼æ‰¿çš„Stateé¡åˆ¥
`Game_1_SymbolStateRegister.ts`
```typescript
export class Game_1_SymbolAllWinState extends SymbolAllWinState {
    private content: Game_1_SymbolContent | null = null;

    constructor(content: Game_1_SymbolContent) {
        super(content);
        this.content = content;
    }

    onPlay() {
        // å¦‚æœæœ‰TimelineToolï¼Œå‰‡æ’­æ”¾çµ±ä¸€çš„ç¸®æ”¾å‹•ç•«
        if (this.content.timelineTool) {
            this.content.timelineTool.play('ScaleEffect', () => {
                this.onEffectFinished();
            });
        } else {
            // æ²’æœ‰TimelineToolä½¿ç”¨åŸæœ‰é‚è¼¯
            super.onPlay();
        }
    }

    onStop() {
        if (this.content.timelineTool) {
            this.content.timelineTool.stop();
            this.onEffectFinished(true);
        } else {
            super.onStop();
        }
    }

    onSkip() {
        if (this.content.timelineTool) {
            this.content.timelineTool.stop();
            this.onEffectFinished(true);
        } else {
            super.onSkip();
        }
    }
}

export class Game_1_SymbolLoopWinState extends SymbolLoopWinState {
    // ç›¸åŒçš„å¯¦ä½œé‚è¼¯ï¼Œä½¿ç”¨çµ±ä¸€çš„'ScaleEffect'å‹•ç•«
}
```

### 3. è¨»å†Šæ–°çš„Stateé¡åˆ¥
```typescript
onRegister() {
    super.onRegister();
    // ... å…¶ä»–è¨»å†Š
    this.registerState(new Game_1_SymbolAllWinState(this.content));
    this.registerState(new Game_1_SymbolLoopWinState(this.content));
}
```

### 4. é‡è¦Bugä¿®æ­£ï¼šScaleé‡ç½®
**å•é¡Œ**ï¼šå‹•ç•«çµæŸå¾Œspinæ–°çš„ä¸€è¼ªï¼Œsymbolå¯èƒ½ä¿æŒæ”¾å¤§ç‹€æ…‹

**è§£æ±ºæ–¹æ¡ˆ**ï¼šåœ¨é—œéµStateä¸­é‡ç½®scale
```typescript
// åœ¨Game_1_SymbolShowStateå’ŒGame_1_RollCycledStateçš„onPlay()ä¸­æ·»åŠ 
// ç¢ºä¿Mainç¯€é»ç¸®æ”¾é‡ç½®ç‚º1
if (this.content.mainSprite) {
    this.content.mainSprite.node.scale = new Vec3(1, 1, 1);
}
```

**ä¿®æ”¹æª”æ¡ˆ**ï¼š
- `Game_1_SymbolShowState.onPlay()`ï¼šsymbolé¡¯ç¤ºæ™‚é‡ç½®
- `Game_1_RollCycledState.onPlay()`ï¼šè½‰è»¸å¾ªç’°æ™‚é‡ç½®

---

## ğŸ¨ Cocos Creatoré…ç½®

### 1. Game_1_Symbol Prefabé…ç½®
1. **åœ¨æ ¹ç¯€é»æ·»åŠ TimelineToolçµ„ä»¶**
2. **åœ¨Mainç¯€é»æ·»åŠ Animationçµ„ä»¶**
3. **å‰µå»ºAnimationClipåç‚º'ScaleEffect'**ï¼š
   - 0.0ç§’ï¼šscale (1, 1, 1)
   - 0.3ç§’ï¼šscale (2, 2, 1)
   - 0.6ç§’ï¼šscale (1, 1, 1)

### 2. TimelineToolé…ç½®
1. **å‰µå»ºTimeline**ï¼šåç¨±è¨­ç‚º'ScaleEffect'
2. **Timeline Type**ï¼šé¸æ“‡Animation
3. **é€£æ¥Animationçµ„ä»¶**ï¼šå°‡Mainç¯€é»çš„Animationæ‹–å…¥
4. **é€£æ¥åˆ°SymbolContent**ï¼šå°‡TimelineToolæ‹–å…¥timelineToolæ¬„ä½

### 3. å‹•ç•«æ•ˆæœ
- **å‹•ç•«æ™‚é•·**ï¼š0.6ç§’
- **ç¸®æ”¾æ•ˆæœ**ï¼š1å€ â†’ 2å€ â†’ 1å€
- **é©ç”¨ç¯„åœ**ï¼šæ‰€æœ‰é…ç½®äº†TimelineToolçš„symbol
- **è¡¨æ¼”éšæ®µ**ï¼šAllWinå’ŒLoopWinéƒ½ä½¿ç”¨ç›¸åŒå‹•ç•«

---

## âœ… å¯¦ä½œå®Œæˆæª¢æŸ¥
1. **å‹•ç•«æ’­æ”¾**ï¼šsymbolä¸­çæ™‚æ­£ç¢ºæ’­æ”¾ç¸®æ”¾å‹•ç•«
2. **çµ±ä¸€æ•ˆæœ**ï¼šAllWinå’ŒLoopWinéšæ®µä½¿ç”¨ç›¸åŒå‹•ç•«
3. **æ¶æ§‹ä¸€è‡´**ï¼šä½¿ç”¨å°ˆæ¡ˆåŸæœ‰çš„TimelineToolç³»çµ±
4. **é€£æ¥æ­£ç¢º**ï¼štimelineToolå±¬æ€§æ­£ç¢ºé€£æ¥åˆ°TimelineToolçµ„ä»¶
5. **Scaleé‡ç½®**ï¼šæ–°spinæ™‚æ‰€æœ‰symboléƒ½å›åˆ°æ­£å¸¸å¤§å°
6. **ç„¡å‰¯ä½œç”¨**ï¼šä¸å½±éŸ¿æ²’æœ‰é…ç½®TimelineToolçš„symbol

## ğŸ› å¸¸è¦‹å•é¡Œæ’é™¤

### å•é¡Œ1ï¼šTimelineToolå‹•ç•«ä¸æ’­æ”¾
**ç—‡ç‹€**ï¼šsymbolä¸­çä½†æ²’æœ‰ç¸®æ”¾å‹•ç•«
**è§£æ±º**ï¼šæª¢æŸ¥timelineToolå±¬æ€§æ˜¯å¦æ­£ç¢ºé€£æ¥åˆ°TimelineToolçµ„ä»¶

### å•é¡Œ2ï¼šSpinå¾Œsymbolä¿æŒæ”¾å¤§ç‹€æ…‹
**ç—‡ç‹€**ï¼šå‹•ç•«æ’­æ”¾å¾Œï¼Œæ–°ä¸€è¼ªspinæ™‚éƒ¨åˆ†symbolé¡¯ç¤ºæ”¾å¤§
**è§£æ±º**ï¼šåœ¨Game_1_SymbolShowStateå’ŒGame_1_RollCycledStateä¸­æ·»åŠ scaleé‡ç½®

### å•é¡Œ3ï¼šå‹•ç•«ç¯€å¥ä¸é€£çºŒ
**ç—‡ç‹€**ï¼šå¤šç¨®symbolè¼ªæµè¡¨æ¼”æ™‚æœ‰"ç­‰ä¸€æ‹"çš„æ„Ÿè¦º
**èªªæ˜**ï¼šé€™æ˜¯æ­£å¸¸ç¾è±¡ï¼Œä¸åŒsymbolçš„è¡¨æ¼”æ™‚é–“ä¸åŒé€ æˆçš„ç¯€å¥è®ŠåŒ–